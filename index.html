<!DOCTYPE html>
<html>
    <head>
        <title>Versho</title>
        <link rel="stylesheet" href="vershostyles.css"/>
        <link rel="icon" href="images/flyingshoes.webp" type="image/x-icon"/>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        
    </head>
    <body>
        <div class="s-layout">
            <div class="s-layout__sidebar" style="z-index: 99999;">
                <header>
                    <img id="logoid" src="images/vershologo.png" style="height:65px;"/>
                    <input type="text" class="searchelement" id="searchbar" value="Nike Air Force 1 Low White"/>
                    <svg id="searchsvg" onclick="onsearch()" class="searchelement" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </header>
                <nav class="s-sidebar__nav">
                    <ul>
                        <li>
                        <a class="s-sidebar__nav-link" href="#versushome" onmouseleave="leavefunc('hometext', 'homeimg', 'images/home.png')" onclick="showshopmodals()" onmouseover="hoverfunc('hometext', 'homeimg', 'images/homeanimated.gif')">
                            <img class="menuicon" id="homeimg" style="height: 25px;" src="images/home.png"/><em id="hometext">Home</em>
                        </a>
                        </li>
                        <li>
                        <a class="s-sidebar__nav-link" href="#trendspage" onmouseleave="leavefunc('trendstext', 'trendimg', 'images/trendchart.png')" onclick="showtrends()" onmouseover="hoverfunc('trendstext', 'trendimg', 'images/trendanimated.gif')">
                            <img class="menuicon" id="trendimg" style="height: 25px;" src="images/trendchart.png"/><em id="trendstext">Trends</em>
                        </a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Content -->

            <main class="s-layout__content">
                <div id="popularmodal" class="modal" style="display:none; border:none;box-shadow:none; width:75%;margin-top:110px;">
                    <div id="popularmodalcontent" class="modal-content" style="border:none;box-shadow:none;">
                      <h3><img style="display: inline; margin-bottom:8px; margin-right:5px;" src="images/trendchart.png"/>Trends</h3>
                      <div id="popularmodalitems">

                      </div>
                    </div>
                </div>
                <div id="nikemodal" class="modal" style="display:block; border:none;box-shadow:none;">
                    <div id="nikemodalcontent" class="modal-content" style="border:none;box-shadow:none;">
                      
                    </div>
                </div>
                <div id="stockxmodal" class="modal" style="display:block; box-shadow:none;border:none;">
                    <div id="stockxmodalcontent" class="modal-content" style="border:none;box-shadow:none;">
                      <img id="stockxlogoid" class="logo" src="images/stockxlogo.jpg" style="width:80px;"/>
                    </div>
                </div>
            </main>

            <script>
                //Intro animation
                setTimeout(function() {
                    document.body.style.opacity = 1;
                    document.body.style.backgroundImage = "none";
                    document.body.style.backgroundSize = "cover";
                    document.body.style.backgroundColor = "#ffffff";
                }, 1500);

                function introAnimation() {
                    document.body.style.opacity = 0;
                    document.body.style.backgroundImage = "url('images/vershologo.png')";
                    document.body.style.backgroundPosition = "center";
                    document.body.style.backgroundSize = "300px";
                }
                introAnimation();

                //Constantly looping scaling function
                setInterval(function() {
                    let sidebar = document.getElementsByClassName('s-sidebar__nav')[0];
                    let nikemodal = document.getElementById("nikemodal");
                    let stockxmodal = document.getElementById("stockxmodal");
                    let logo = document.getElementById('logoid');
                    let search = document.getElementById('searchbar');
                    let searchbtn = document.getElementById('searchsvg');
                    let popularmodal = document.getElementById('popularmodalcontent');
                    if(sidebar.getBoundingClientRect().width >= 56) {
                        popularmodal.style.marginLeft = '267px';
                        nikemodal.style.marginLeft = '220px';
                        search.style.marginLeft = '265px';
                        search.style.fontSize = '1.25em';
                        searchbtn.style.marginLeft = '515px';
                        stockxmodal.style.height = '80%';
                        nikemodal.style.height = '80%';
                        stockxmodal.style.width = '37%';
                        nikemodal.style.width = '37%';
                        stockxmodal.style.marginLeft = `${nikemodal.getBoundingClientRect().width + nikemodal.offsetLeft+30}px`;
                        stockxmodal.style.marginTop = `100px`;
                        logo.src = "images/vershologo.png";
                        logo.style.height = '65px';
                        if(document.body.contains(document.getElementsByClassName('css-4qyi6t-BannerPaddingWrapper')[0]))
                            document.getElementsByClassName('css-4qyi6t-BannerPaddingWrapper')[0].style.paddingTop = '40px';
                    }
                    if (sidebar.getBoundingClientRect().width <= 56) {
                        popularmodal.style.marginLeft = '117px';
                        nikemodal.style.marginLeft = '70px';
                        search.style.marginLeft = '90px';
                        search.style.fontSize = '1em';
                        searchbtn.style.marginLeft = '275px';
                        stockxmodal.style.height = '55%';
                        nikemodal.style.height = '45%';
                        stockxmodal.style.width = '87%';
                        nikemodal.style.width = '90%';
                        stockxmodal.style.marginLeft = `${nikemodal.offsetLeft+20}px`;
                        stockxmodal.style.marginTop = `${nikemodal.offsetHeight+110}px`;
                        logo.src = "images/flyingshoes.png";
                        logo.style.height = '45px';
                        if(document.body.contains(document.getElementsByClassName('css-4qyi6t-BannerPaddingWrapper')[0]))
                            document.getElementsByClassName('css-4qyi6t-BannerPaddingWrapper')[0].style.paddingTop = '100px';
                    }
                    
                }, 0);
                function showshopmodals () {
                    let nikemodal = document.getElementById('nikemodal');
                    let stockxmodal = document.getElementById('stockxmodal');
                    let popularmodal = document.getElementById('popularmodal');
                    nikemodal.style.display = 'block';
                    stockxmodal.style.display = 'block';
                    popularmodal.style.display = 'none';
                }
                function showtrends () {
                    let nikemodal = document.getElementById('nikemodal');
                    let stockxmodal = document.getElementById('stockxmodal');
                    let popularmodal = document.getElementById('popularmodal');
                    nikemodal.style.display = 'none';
                    stockxmodal.style.display = 'none';
                    popularmodal.style.display = 'block';
                }
                //Callback to nike store XMLHTTPREQUEST
                function nikereqListener () {
                    e = document.getElementById('nikemodalcontent');
                    var child = e.lastElementChild; 
                    while (child) {
                        e.removeChild(child);
                        child = e.lastElementChild;
                    }
                    //Unecessary GUI removal
                    document.getElementById('nikemodalcontent').insertAdjacentHTML('beforeend', this.responseText);
                    document.getElementById('MobileMenuButton').remove();
                    document.getElementsByClassName('l-footer bg-black u-full-width n52bd')[0].remove();
                    //Specific html node removals
                    document.getElementsByClassName('pre-l-wrapper mauto-sm d-sm-flx flx-dir-sm-r flx-jc-sm-sb flx-wr-sm-nw')[0].remove();
                    document.getElementsByClassName('pre-l-brand-header d-sm-h d-lg-b z3')[0].remove();
                    document.getElementsByClassName('icon-btn ripple d-sm-b')[0].remove();
                    document.getElementsByClassName('pre-btn-header ripple mr3-sm d-sm-h d-lg-ib')[0].remove();
                    document.getElementsByClassName('pre-search-input-box d-sm-b flx-dir-lg-c flx-ai-lg-fe d-lg-flx flx-gro-sm-1 flx-gro-lg-0')[0].remove();
                    
                    //Image card removals
                    let imagecards = document.getElementsByClassName('product-card__hero-image');
                    while(imagecards.length > 0) {
                        for(let n = 0; n < imagecards.length; n++)
                            imagecards[n].remove();
                    }
                }
                function stockxreqListener () {
                    e = document.getElementById('stockxmodalcontent');
                    var child = e.lastElementChild; 
                    while (child) {
                        if(child == document.getElementById('stockxlogoid')) {
                            break;
                        }
                        e.removeChild(child);
                        child = e.lastElementChild;
                    }
                    document.getElementById('stockxmodalcontent').insertAdjacentHTML('beforeend', this.responseText);
                }
                function popularreqListener () {
                    document.getElementById('popularmodalitems').insertAdjacentHTML('beforeend', this.responseText);
                    document.getElementById('site-header').remove();
                    document.getElementsByClassName('css-1kb2y9b-StyledBrowseHeader')[0].remove();
                    document.getElementsByClassName('col-md-2 col-xs-12 side-filters hidden-xs hidden-sm')[0].remove();
                    document.getElementsByClassName('hidden-xs hidden-sm')[0].remove();
                    document.getElementsByClassName('css-104arvh')[0].remove();
                    document.getElementsByClassName('css-zfbjl9-PaginationContainer')[0].remove();
                    document.getElementsByClassName('css-18kmo86-ButtonRow')[0].remove();
                    document.getElementsByClassName('css-16q9pr7')[0].remove();
                    document.getElementsByClassName('css-4qyi6t-BannerPaddingWrapper')[0].style.paddingTop = '40px';
                    document.getElementsByClassName('chakra-container css-bu55a7')[0].style.padding = '0px';
                    let imagecards = document.getElementsByClassName('css-1u0qmvp euld1y70');
                    let mainfavicon = document.getElementsByTagName('link')[1].cloneNode();
                    document.head.append(mainfavicon);
                    while(imagecards.length > 0) {
                        for(let n = 0; n < imagecards.length; n++)
                            imagecards[n].remove();
                    }
                }
                function onsearch () {
                    let querystring = document.getElementsByClassName('searchelement')[0].value.toString();
                    console.log(querystring);
                    var nikereq = new XMLHttpRequest();
                    var stockxreq = new XMLHttpRequest();

                    nikereq.addEventListener("load", nikereqListener);
                    nikereq.open("GET", `https://www.nike.com/w?q=${querystring}&vst=${querystring}`);
                    nikereq.send();
                    
                    stockxreq.addEventListener("load", stockxreqListener);
                    stockxreq.open("GET", `https://sleepy-waters-67122.herokuapp.com/getstockx/${querystring}`);
                    stockxreq.send();
                }
                function getpopularsales () {
                    var popularreq = new XMLHttpRequest();
                    popularreq.addEventListener("load", popularreqListener);
                    popularreq.open("GET", `https://stockx.com/sneakers/most-popular`);
                    popularreq.send();
                }
                onsearch();
                getpopularsales();
                //Sidebar functions
                function leavefunc (textid, iconid, iconurl) {
                    document.getElementById(textid).style.color = '#333333';
                    document.getElementById(iconid).src = iconurl;
                }
                function hoverfunc (textid, iconid, iconurl) {
                    document.getElementById(textid).style.color = 'white';
                    document.getElementById(iconid).src = iconurl;
                }

            </script>
            
        </div>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    </body>
</html>